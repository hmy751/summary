# Virtual DOM
---
리액트에서 Virtual DOM은 브라우저의 DOM과는 다르다. 
우선 브라우저의 DOM은 객체 기반의 구조화된 문서 표현이며 브라우저 렌더링에 표현되는 HTML요소들을 나타내고 이를 조작할 수 도 있다.
리액트의 Virtual DOM은 브라우저 DOM과 유사하지만, DOM의 정보를 복사한 형태로 자바스크립트 객체로 이를 나타내고 메모리에 저장하는 가상의 돔이라고 볼수 있다. 실제 브라우저에서 직접 접근하여 UI를 조작하는데는 사용되지 않고, 단지 리액트에서 리렌더링 시 UI변화를 비교하기 위해 사용된다.

## Reconciliation

리액트에서 상태등의 변화가 일어나면 변화된 부분들을 비교하여 이를 실제 브라우저에 DOM에 반영하는 과정을 재조정(Reconciliation)이라고 한다.
재조정은 버츄어 돔(Virtual DOM)과 리액트 파이버(Fiber)아키텍처를 이용하여 일어난다.
먼저 리액트내 상태 변화가 일어나면 기존에 있던 버츄어 돔은 유지한채로 변화가 일어난 부분을 반영한 새로운 버츄어 돔을 만든다. 

새로운 버츄어 돔과 기존 버츄어 돔에서 Diff 알고리즘을 통해 변경된 부분을 감지하고, 리액트 파이버 아키텍쳐가 변경된 부분을 작업단위로 나누어 우선순위에 따라 중요한 작업을 우선으로 처리하며, 비동기적으로 처리된다.

## React Fiber
https://github.com/acdlite/react-fiber-architecture
파이버는 각 노드에 대한 

- reconciler는 트리의 어떤 부분이 변경되었는지를 계산하는 작업을 수행한다. Fiber는 Reconsiler을 재구현한 것이며 원칙적으로 렌더링과 관련이 없다.
- fiber안에서 diff알고리즘 방식으로 비교하여 버츄어 돔 변경사항을 확인한 후 작업을 나눈다

- fiber의 목적은 리액트가 스케쥴링의 이점을 얻는 것이고 그럴려면 4가지 원칙을 지켜야 한다.
  UI 렌더링을 최적화하기 위해 호출 스택의 동작을 사용자 정의할 수 있다면 좋지 않을까요? 호출 스택을 마음대로 중단하고 스택 프레임을 수동으로 조작할 수 있다면 좋지 않을까요?

이것이 React Fiber의 목적입니다. Fiber는 React 구성 요소에 특화된 스택의 재구현입니다. 단일 Fiber를 **가상 스택 프레임** 으로 생각할 수 있습니다 .

스택을 재구현하는 이점은 [스택 프레임을 메모리에 보관 하고 원하는 대로(그리고](https://www.facebook.com/groups/2003630259862046/permalink/2054053404819731/) _언제든지_ ) 실행할 수 있다는 것입니다 . 이는 스케줄링에 대한 목표를 달성하는 데 중요합니다.

- diff알고리즘은 버츄어 돔간의 변화를 비교 하는 알고리즘이다.




https://d2.naver.com/helloworld/2690975
https://callmedevmomo.medium.com/virtual-dom-react-%ED%95%B5%EC%8B%AC%EC%A0%95%EB%A6%AC-bfbfcecc4fbb

맞습니다! 해당 글에서 언급된 "고수준 알고리즘"이라는 표현은 **Fiber** 아키텍처에 대한 설명이 맞습니다. **Fiber는 React의 새로운 Reconciler(재조정기)**를 구현한 것이고, 그 재조정 과정에서의 **diff 알고리즘** 역시 Fiber의 일부로 작동합니다.

여기서 중요한 것은, **Fiber**는 React의 **Reconciler를 완전히 재구현**한 것이고, 그 안에 **diff 알고리즘**도 포함된다는 점입니다. 즉, 이전에도 사용되던 **diff 알고리즘의 원칙**은 그대로 유지되지만, 그 과정이 **Fiber 아키텍처 내에서 새롭게 관리**되고 있는 것입니다.

### Fiber의 역할

**Fiber**는 이전 React와 다른 점이 있는데, **작업을 더 세밀하게 나누어 처리**하고, 각 작업의 **우선순위를 지정**하여 UI 업데이트를 최적화합니다. Fiber는 이렇게 더 유연한 방식으로 **reconciliation 과정**을 처리하면서도, **기존 diff 알고리즘의 동작 방식을 그대로 따릅니다**.

### 고수준 알고리즘이란?

글에서 언급된 "고수준 알고리즘"은 다음 두 가지 개념을 함께 가리키고 있습니다:

1. **diff 알고리즘**: Virtual DOM 트리를 비교하여 변경된 부분을 감지하는 기본 원칙. 여기서 "서로 다른 컴포넌트는 완전히 교체한다"는 것도 이 기본 원칙에 속합니다.
    
2. **Fiber 구조를 기반으로 한 처리 방식**: 기존의 diff 알고리즘을 더 효율적으로 처리하기 위해 작업을 쪼개고, 작업의 우선순위를 지정하며, 이를 비동기적으로 실행할 수 있는 구조를 도입했습니다. 이로 인해 React는 UI 업데이트를 더 빠르고 효율적으로 할 수 있게 되었습니다.
    

### 결론: Fiber와 diff 알고리즘의 관계

- **Fiber 아키텍처**는 **React의 새로운 Reconciler**로, 기존의 diff 알고리즘을 포함하고 있습니다. 즉, **diff 알고리즘은 여전히 React의 핵심 부분**이며, Fiber는 이 알고리즘을 관리하는 **보다 세밀한 작업 처리 방식**을 제공합니다.
    
- **"서로 다른 컴포넌트 유형은 완전히 교체한다"**는 것은 **diff 알고리즘의 중요한 원칙**입니다. 이 원칙은 **Fiber 아키텍처 내에서도 유지**되며, Fiber는 이를 더 효율적으로 관리하기 위해 작업 단위와 우선순위 같은 기능을 추가한 것입니다.
    

따라서, 해당 설명은 **Fiber 아키텍처**에 대한 내용이 맞지만, 그 안에서 **diff 알고리즘**이 여전히 중요한 역할을 수행하고 있다는 것을 이해하시면 좋습니다.