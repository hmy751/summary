# 실행 컨텍스트
---
실행 컨텍스트는 실행할 코드에 제공할 환경 정보들을 모아놓은 객체이다.

처음 코드가 실행될 때, 전역 공간에 대한 실행 컨텍스트가 생성된다. 이후 함수가 호출될 때마다, 해당 함수에 대한 실행 컨텍스트가 평가 시점에 생성되고, 함수의 변수와 식별자 등의 정보를 수집한다.

평가를 마친 실행 컨텍스트는 콜 스택에 담기고, 이 콜 스택은 가장 최신의 자료가 맨 위로 쌓이는 스택 자료구조로 동작한다. 코드를 실행하는 과정은 다음과 같다.

1. **전역 컨텍스트 생성**: 코드를 처음 실행하면 전역 공간에 대한 실행 컨텍스트가 생성된다.
2. **평가 및 컨텍스트 생성**: 함수 호출부를 만나면 해당 함수에 대한 실행 컨텍스트가 생성되고, 변수와 식별자 정보를 수집한다.
3. **콜 스택에 추가**: 평가를 마친 실행 컨텍스트는 콜 스택에 담기며, 실행을 시작한다.
4. **콜 스택 최상단 기준 실행**: 실행은 콜 스택의 최상단에 있는 실행 컨텍스트를 기준으로 진행된다.
5. **중단 및 재개**: 새로운 함수 호출을 만나면 해당 함수의 실행 컨텍스트가 생성되어 콜 스택에 추가되고, 이전 컨텍스트의 실행은 일시 중단된다. 새로운 컨텍스트의 실행이 끝나면 콜 스택에서 제거되고, 이전 컨텍스트의 실행이 재개된다.

이 과정을 반복하면서 코드가 실행됩니다.

# 실행 컨텍스트의 구성
---
실행 컨텍스트의 구성은 아래와 같이 3가지로 구성되어 있다.
- VariableEnvironment
  - environmentRecord
  - outerEnvironmentReference
- LexicalEnvironment
  - environmentRecord
  - outerEnvironmentReference
- ThisBinding

- VariableEnvironment
VariableEnvironment는 실행 컨테스트를 생성할 때 만들어지며 스냅샷의 목적으로 변경되지 않고 유지 된다.
VariableEnvironment을 생성한 후 바로 복사하여 LexicalEnvironment를 만든다.

- LexicalEnvironment
LexicalEnvironment는 실행 컨텍스트 내부의 변경 사항이 실시간으로 반영되며 실질적으로 활용되는 객체이다.
환경정보에는 environmentRecord와 outerEnvironmentReference로 구성되어 있다.

- ThisBinding
실행 컨텍스트의 ThisBinding에는 this로 지정된 객체가 저장된다. 실행 컨텍스트 활성화 당시 this가 지정되지 않은 경우 전역 객체가 저장된다.

## environmentRecord, 호이스팅
environmentRecord에는 현재 컨텍스트와 관련된 코드의 식별자 정보들이 저장된다.
수집할 때는 컨텍스트 내부 전체를 처음 부터 끝까지 순서대로 수집한다.
실행 컨텍스트는 코드의 실행 전 평가 과정에서 생성되며 이때 코드를 식별자 정보를 수집하여 environmentRecord에 저장하게 된다.
이때 실행전 평가 과정에서 미리 수집을 하기 때문에 실행 전에 
실행 컨텍스트 생성 과정에서 식별자 정보를 먼저 수집하기 때문에, 선언된 변수 이전에 실행된 코드에서 변수를 참조할 수 있게 되며 호이스팅 현상이 발생한다.
호이스팅은 선언된 변수가 이전에 실행될 코드 위에서 먼저 참조되어 마치 끌어올려져서 해석되는 현상을 말한다.

## outerEnvironmentReference, 스코프 스코프 체인
outerEnvironmentReference는 해당 컨텍스트의 함수가 선언되는 시점의 LexicalEnvironment를 담으며 이러한 이유로 해당 컨텍스트 뿐만 아니라 선언되는 시점에 있는 바깥의 컨텍스트의 식별자 정보를 참조할 수 있게 된다.
이러한 outerEnvironmentReference의 특성으로 스코프 체인 현상이 발생한다.
먼저 스코프는 식별자에 대한 유효범위를 말하며, 스코프 체인은 바깥의 컨텍스트의 식별자 정보를 참조할 수 잇는 특성으로 인해 스코프를 안에서 부터 바깥으로 차례로 검색해나가는 것을 말한다.


